<div class="create-event-container">
  
  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title">
      <span class="header-icon">{{ isUpdateMode ? 'âœï¸' : 'ğŸ“…' }}</span>
      {{ isUpdateMode ? 'Update Event' : 'Create Event' }}
    </h1>
    <p class="page-subtitle">
      {{ isUpdateMode ? 'Modify event details below' : 'Plan and schedule your upcoming events' }}
    </p>
  </div>
 
  <!-- Success Message -->
  <div class="alert alert-success" *ngIf="showMessage">
    <span class="alert-icon">âœ“</span>
    <span class="alert-text">{{ responseMessage }}</span>
    <button class="alert-close" (click)="closeAlert()">Ã—</button>
  </div>
 
  <!-- Error Message -->
  <div class="alert alert-error" *ngIf="showError">
    <span class="alert-icon">âš </span>
    <span class="alert-text">{{ errorMessage }}</span>
    <button class="alert-close" (click)="closeAlert()">Ã—</button>
  </div>
 
  <!-- Create/Update Event Form -->
  <div class="form-section">
    <div class="section-header">
      <h2 class="section-title">
        <span class="section-icon">{{ isUpdateMode ? 'âœï¸' : 'â•' }}</span>
        Event Details
      </h2>
      <p class="section-description">
        {{ isUpdateMode ? 'Update the event information' : 'Fill in the information below to create a new event' }}
      </p>
    </div>
 
    <form [formGroup]="itemForm" (ngSubmit)="onSubmit()">
      <div class="form-grid">
        
        <!-- Event Title -->
        <div class="form-group">
          <label for="title" class="form-label">
            Event Title <span class="required">*</span>
          </label>
          <input
            type="text"
            id="title"
            formControlName="title"
            class="form-input"
            placeholder="Enter event title"
            [class.error-input]="itemForm.get('title')?.invalid && itemForm.get('title')?.touched">
          <div class="error-text" *ngIf="itemForm.get('title')?.invalid && itemForm.get('title')?.touched">
            Event title is required
          </div>
        </div>
 
        <!-- Location -->
        <div class="form-group">
          <label for="location" class="form-label">
            Location <span class="required">*</span>
          </label>
          <input
            type="text"
            id="location"
            formControlName="location"
            class="form-input"
            placeholder="Enter event location"
            [class.error-input]="itemForm.get('location')?.invalid && itemForm.get('location')?.touched">
          <div class="error-text" *ngIf="itemForm.get('location')?.invalid && itemForm.get('location')?.touched">
            Location is required
          </div>
        </div>
 
        <!-- Date & Time -->
        <div class="form-group">
          <label for="dateTime" class="form-label">
            Date & Time <span class="required">*</span>
          </label>
          <input
            type="datetime-local"
            id="dateTime"
            formControlName="dateTime"
            class="form-input"
            [min]="minDate"
            [class.error-input]="itemForm.get('dateTime')?.invalid && itemForm.get('dateTime')?.touched">
          <div class="error-text" *ngIf="itemForm.get('dateTime')?.invalid && itemForm.get('dateTime')?.touched">
            Date and time is required
          </div>
        </div>
 
        <!-- Status -->
        <div class="form-group">
          <label for="status" class="form-label">
            Event Status <span class="required">*</span>
          </label>
          <select
            id="status"
            formControlName="status"
            class="form-select"
            [class.error-input]="itemForm.get('status')?.invalid && itemForm.get('status')?.touched">
            <option value="" disabled selected>Select status</option>
            <option value="upcoming">Upcoming</option>
            <option value="ongoing">Ongoing</option>
            <option value="completed">Completed</option>
            <option value="cancelled">Cancelled</option>
          </select>
          <div class="error-text" *ngIf="itemForm.get('status')?.invalid && itemForm.get('status')?.touched">
            Status is required
          </div>
        </div>
 
        <!-- Description -->
        <div class="form-group full-width">
          <label for="description" class="form-label">
            Description <span class="required">*</span>
          </label>
          <textarea
            id="description"
            formControlName="description"
            class="form-textarea"
            rows="4"
            placeholder="Enter event description"
            [class.error-input]="itemForm.get('description')?.invalid && itemForm.get('description')?.touched"></textarea>
          <div class="error-text" *ngIf="itemForm.get('description')?.invalid && itemForm.get('description')?.touched">
            Description is required
          </div>
        </div>
 
      </div>
 
      <div class="form-actions">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="itemForm.invalid">
          <span class="btn-icon">{{ isUpdateMode ? 'ğŸ’¾' : 'â•' }}</span>
          <span class="btn-text">{{ isUpdateMode ? 'Update Event' : 'Create Event' }}</span>
        </button>
 
        <button
          type="button"
          class="btn btn-secondary"
          (click)="isUpdateMode ? cancelUpdate() : itemForm.reset()">
          <span class="btn-icon">{{ isUpdateMode ? 'âœ–' : 'ğŸ”„' }}</span>
          <span class="btn-text">{{ isUpdateMode ? 'Cancel' : 'Reset Form' }}</span>
        </button>
      </div>
    </form>
  </div>
 
  <!-- âœ… FIXED: Search Section with Auto-Search -->
  <div class="search-section">
    <div class="section-header">
      <h2 class="section-title">
        <span class="section-icon">ğŸ”</span>
        Manage Events
      </h2>
      <p class="section-description">Search and manage your created events</p>
    </div>
 
    <div class="search-bar">
      <!-- âœ… AUTO-SEARCH: Triggers search on every keystroke -->
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (input)="onSearch()"
        placeholder="Search by Event ID or Title..."
        class="search-input">
 
      <!-- âœ… FIXED: Clear button -->
      <button
        class="btn btn-secondary"
        (click)="searchQuery = ''; loadAllEvents()"
        *ngIf="searchQuery">
        <span class="btn-icon">âœ–</span>
        <span class="btn-text">Clear</span>
      </button>
    </div>
  </div>
 
  <!-- Events List -->
  <div class="events-list-section">
    <div class="section-header">
      <h2 class="section-title">
        <span class="section-icon">ğŸ“‹</span>
        All Events
        <span class="event-count">({{ events.length }})</span>
      </h2>
    </div>
 
    <!-- Events Table -->
    <div class="table-wrapper" *ngIf="paginatedEvents.length > 0">
      <table class="events-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Description</th>
            <th>Date & Time</th>
            <th>Location</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let event of paginatedEvents">
            <td class="event-id">{{ event.eventID }}</td>
            <td class="event-title">{{ event.title }}</td>
            <td class="event-description">{{ event.description }}</td>
            <td class="event-datetime">
              <span class="datetime-badge">
                <i class="bi bi-calendar3"></i>
                {{ event.dateTime | date:'medium' }}
              </span>
            </td>
            <td class="event-location">
              <span class="location-badge">
                <i class="bi bi-geo-alt-fill"></i>
                {{ event.location }}
              </span>
            </td>
            <td>
              <span class="status-badge"
                [ngClass]="{
                  'status-upcoming': event.status === 'upcoming',
                  'status-ongoing': event.status === 'ongoing',
                  'status-completed': event.status === 'completed',
                  'status-cancelled': event.status === 'cancelled'
                }">
                {{ event.status | titlecase }}
              </span>
            </td>
            <td class="actions-cell">
              <div class="action-buttons">
                <button
                  class="btn-action btn-edit"
                  (click)="editEvent(event)"
                  title="Edit Event">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button
                  class="btn-action btn-delete"
                  (click)="deleteEvent(event.eventID)"
                  title="Delete Event">
                  <i class="bi bi-trash3"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
 
    <!-- Empty State -->
    <div class="empty-state" *ngIf="paginatedEvents.length === 0">
      <div class="empty-icon">ğŸ“­</div>
      <h3 class="empty-title">No Events Found</h3>
      <p class="empty-text">
        {{ searchQuery ? 'Try a different search term' : 'Start by creating your first event above' }}
      </p>
    </div>
 
    <!-- Pagination -->
    <div class="pagination" *ngIf="events.length > 0">
      <button
        class="btn btn-pagination"
        (click)="previousPage()"
        [disabled]="currentPage === 1">
        <span class="pagination-icon">â€¹</span>
        <span class="pagination-text">Previous</span>
      </button>
 
      <span class="page-info">
        <span class="page-label">Page</span>
        <span class="current-page">{{ currentPage }}</span>
        <span class="separator">of</span>
        <span class="total-pages">{{ totalPages }}</span>
      </span>
 
      <button
        class="btn btn-pagination"
        (click)="nextPage()"
        [disabled]="currentPage >= totalPages">
        <span class="pagination-text">Next</span>
        <span class="pagination-icon">â€º</span>
      </button>
    </div>
  </div>
 
</div>